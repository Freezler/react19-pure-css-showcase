/* ðŸš€ CSS Cascade Layers for organized styling - 2025 Edition with modern features */
@layer reset, properties, theme, layout, components, utilities, states, animations, enhancements;

@layer reset {
  /* Modern CSS Reset */
  *,
  *::before,
  *::after {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
  }

  html {
    color-scheme: light dark;
    hanging-punctuation: first last;
    overflow-x: hidden; /* Prevent horizontal scroll */
    
    /* Modern CSS features */
    text-size-adjust: none; /* Prevent text scaling on mobile */
    -webkit-text-size-adjust: none;
    -moz-text-size-adjust: none;
    
    /* Improved focus indicators */
    &:focus-within {
      scroll-behavior: smooth;
    }
  }

  body {
    min-height: 100vh;
    min-height: 100dvh; /* Dynamic viewport height for mobile */
    font-family: system-ui, -apple-system, sans-serif;
    line-height: 1.5;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    overflow-x: hidden; /* Prevent horizontal scroll */
    
    /* Modern text rendering */
    text-rendering: optimizeLegibility;
    font-feature-settings: "kern" 1, "liga" 1;
    font-variant-ligatures: common-ligatures;
    
    /* Enhanced scrolling behavior */
    scroll-behavior: smooth;
    scroll-padding-top: 2rem;
    overscroll-behavior: contain;
  }

  img,
  picture,
  video,
  canvas,
  svg {
    display: block;
    max-width: 100%;
    height: auto;
  }

  input,
  button,
  textarea,
  select {
    font: inherit;
  }

  p,
  h1,
  h2,
  h3,
  h4,
  h5,
  h6 {
    overflow-wrap: break-word;
  }

  /* Remove default button styles */
  button {
    background: none;
    border: none;
    cursor: pointer;
  }

  /* Remove default list styles */
  ul,
  ol {
    list-style: none;
  }

  /* Remove default link styles */
  a {
    text-decoration: none;
    color: inherit;
  }
}

@layer properties {
  /* CSS Custom Properties - No @property rules to avoid console warnings */
  :root {
    --hue: 250;
    --saturation: 15%;
    --lightness: 70%;
    --alpha: 1;
    --space-multiplier: 1;
    --scale-factor: 1;
  }
}

@layer theme {
  /* CSS Custom Properties for Design System */
  :root {
    /* Base colors using modern color spaces */
    --color-primary: oklch(70% 0.15 250);
    --color-primary-hover: oklch(65% 0.15 250);
    --color-secondary: oklch(80% 0.1 180);
    --color-accent: oklch(75% 0.2 350);

    /* Neutral colors */
    --color-surface: oklch(98% 0.01 250);
    --color-surface-variant: oklch(94% 0.02 250);
    --color-on-surface: oklch(20% 0.01 250);
    --color-on-surface-variant: oklch(40% 0.02 250);

    /* Semantic color tokens - following docs guidance */
    --color-success: oklch(70% 0.15 120);
    --color-success-bg: oklch(from var(--color-success) l c h / 0.1);
    --color-warning: oklch(75% 0.15 60);
    --color-warning-bg: oklch(from var(--color-warning) l c h / 0.1);
    --color-error: oklch(65% 0.15 25);
    --color-error-bg: oklch(from var(--color-error) l c h / 0.1);
    --color-info: oklch(70% 0.15 220);
    --color-info-bg: oklch(from var(--color-info) l c h / 0.1);

    /* Interactive states */
    --color-focus: var(--color-primary);
    --color-focus-ring: oklch(from var(--color-primary) l c h / 0.2);
    --color-border: var(--color-surface-variant);
    --color-border-hover: var(--color-primary);

    /* Dark mode colors */
    --color-surface-dark: oklch(15% 0.01 250);
    --color-surface-variant-dark: oklch(20% 0.02 250);
    --color-on-surface-dark: oklch(90% 0.01 250);
    --color-on-surface-variant-dark: oklch(70% 0.02 250);

    /* Spacing scale */
    --space-3xs: 0.25rem;
    --space-2xs: 0.5rem;
    --space-xs: 0.75rem;
    --space-sm: 1rem;
    --space-md: 1.5rem;
    --space-lg: 2rem;
    --space-xl: 3rem;
    --space-2xl: 4rem;
    --space-3xl: 6rem;
    --space-4xl: 8rem;

    /* Fluid spacing */
    --space-fluid-sm: clamp(1rem, 2vw, 1.5rem);
    --space-fluid-md: clamp(1.5rem, 4vw, 2rem);
    --space-fluid-lg: clamp(2rem, 6vw, 4rem);

    /* Typography scale */
    --text-xs: clamp(0.75rem, 0.7rem + 0.2vw, 0.875rem);
    --text-sm: clamp(0.875rem, 0.8rem + 0.3vw, 1rem);
    --text-base: clamp(1rem, 0.96rem + 0.22vw, 1.125rem);
    --text-lg: clamp(1.125rem, 1.08rem + 0.25vw, 1.25rem);
    --text-xl: clamp(1.25rem, 1.18rem + 0.3vw, 1.5rem);
    --text-2xl: clamp(1.5rem, 1.4rem + 0.5vw, 2rem);
    --text-3xl: clamp(1.875rem, 1.7rem + 0.9vw, 2.5rem);

    /* Border radius system */
    --radius-xs: 0.125rem;    /* 2px - tiny elements */
    --radius-sm: 0.25rem;     /* 4px - small components */
    --radius-md: 0.5rem;      /* 8px - default buttons, inputs */
    --radius-lg: 0.75rem;     /* 12px - default cards */
    --radius-xl: 1rem;        /* 16px - large cards */
    --radius-2xl: 1.5rem;     /* 24px - hero cards, special elements */
    --radius-3xl: 2rem;       /* 32px - extra large components */
    --radius-full: 9999px;    /* full rounded */

    /* Shadows using OKLCH */
    --shadow-sm: 0 1px 2px 0 oklch(0% 0 0 / 0.05);
    --shadow-md: 0 4px 6px -1px oklch(0% 0 0 / 0.1),
      0 2px 4px -2px oklch(0% 0 0 / 0.1);
    --shadow-lg: 0 10px 15px -3px oklch(0% 0 0 / 0.1),
      0 4px 6px -4px oklch(0% 0 0 / 0.1);
    --shadow-xl: 0 20px 25px -5px oklch(0% 0 0 / 0.1),
      0 10px 10px -5px oklch(0% 0 0 / 0.04);

    /* Transitions */
    --transition-fast: 150ms ease-out;
    --transition-normal: 250ms ease-out;
    --transition-slow: 350ms ease-out;

    /* Z-index scale */
    --z-dropdown: 1000;
    --z-sticky: 1020;
    --z-fixed: 1030;
    --z-modal-backdrop: 1040;
    --z-modal: 1050;
    --z-popover: 1060;
    --z-tooltip: 1070;
    --z-toast: 1080;

    /* Component sizing */
    --size-icon-sm: 16px;
    --size-icon-md: 20px;
    --size-icon-lg: 24px;
    --size-icon-xl: 32px;

    /* Line heights */
    --leading-none: 1;
    --leading-tight: 1.25;
    --leading-normal: 1.5;
    --leading-relaxed: 1.75;

    /* Container sizes */
    --container-sm: 640px;
    --container-md: 768px;
    --container-lg: 1024px;
    --container-xl: 1200px;
    --container-2xl: 1400px;

    /* Modern content width patterns (2025) */
    --content-prose: min(90vw, 65ch);       /* Articles, blog posts */
    --content-reading: min(90vw, 70ch);     /* Long text content */
    --content-form: min(90vw, 500px);       /* Forms, inputs */
    --content-narrow: min(90vw, 60ch);      /* Intimate content */
    --content-wide: min(95vw, var(--container-xl)); /* Galleries, showcases */
    --content-full: 100vw;                  /* Full bleed sections */
  }

  /* Dark mode support */
  @media (prefers-color-scheme: dark) {
    :root {
      --color-surface: var(--color-surface-dark);
      --color-surface-variant: var(--color-surface-variant-dark);
      --color-on-surface: var(--color-on-surface-dark);
      --color-on-surface-variant: var(--color-on-surface-variant-dark);
    }
  }

  /* Theme variants - Enhanced light/dark system */
  [data-theme="dark"] {
    --color-surface: var(--color-surface-dark);
    --color-surface-variant: var(--color-surface-variant-dark);
    --color-on-surface: var(--color-on-surface-dark);
    --color-on-surface-variant: var(--color-on-surface-variant-dark);
  }

  /* ðŸŒ… PERFECT LIGHT MODE - Optimized for readability and aesthetics */
  [data-theme="light"] {
    /* Premium light surfaces with subtle warmth */
    --color-surface: oklch(99% 0.003 60);           /* Warm white, not sterile */
    --color-surface-variant: oklch(96% 0.005 60);   /* Soft contrast */
    --color-on-surface: oklch(15% 0.01 250);        /* Rich dark text */
    --color-on-surface-variant: oklch(35% 0.02 250); /* Medium contrast */
    
    /* Enhanced primary colors for light mode */
    --color-primary: oklch(55% 0.18 250);           /* Richer, more saturated */
    --color-primary-hover: oklch(50% 0.18 250);     /* Deeper on hover */
    --color-secondary: oklch(65% 0.12 300);         /* Complementary purple */
    
    /* Light mode specific refinements */
    --color-outline: oklch(85% 0.01 250);           /* Soft borders */
    --color-success: oklch(65% 0.15 150);           /* Fresh green */
    --color-error: oklch(65% 0.15 20);              /* Warm red */
    --color-warning: oklch(70% 0.12 80);            /* Golden yellow */
    
    /* Card and component backgrounds with depth */
    --card-bg-light: oklch(100% 0 0);               /* Pure white cards */
    --navbar-bg-light: oklch(99% 0.002 60 / 0.8);  /* Semi-transparent navbar */
  }
}

@layer layout {
  /* ðŸŽ¨ SMOOTH THEME TRANSITIONS - The magic happens here! */
  :root {
    /* Smooth theme switching using CSS custom properties */
    transition: 
      color 0.4s cubic-bezier(0.4, 0, 0.2, 1),
      background-color 0.4s cubic-bezier(0.4, 0, 0.2, 1),
      border-color 0.4s cubic-bezier(0.4, 0, 0.2, 1),
      box-shadow 0.4s cubic-bezier(0.4, 0, 0.2, 1);
  }

  /* Apply smooth transitions to all elements using our color variables */
  *, *::before, *::after {
    transition: inherit;
  }

  /* Respect reduced motion preference - accessibility first! */
  @media (prefers-reduced-motion: reduce) {
    :root, *, *::before, *::after {
      transition: none !important;
      animation: none !important;
    }
  }

  /* Layout stabilization */
  html {
    height: 100%;
  }

  body {
    min-height: 100vh;
    display: flex;
    flex-direction: column;
  }

  #root {
    display: flex;
    flex-direction: column;
    flex: 1;
    min-height: 100vh;
  }

  /* ðŸš€ Enhanced Layout primitives with modern CSS features */
  .stack {
    --stack-space: var(--space, var(--space-md));
    display: flex;
    flex-direction: column;

    /* ðŸŽ¨ Enhanced stack with :has() selector */
    &:has(> .stack__header) {
      --stack-space: var(--space-lg);
      
      > .stack__header {
        padding-bottom: var(--space-sm);
        border-bottom: 1px solid var(--color-outline);
        margin-bottom: var(--space-md);
      }
    }

    > * + * {
      margin-top: var(--stack-space);
    }
  }

  .cluster {
    --cluster-gap: var(--gap, var(--space-md));
    --cluster-justify: var(--justify, flex-start);
    --cluster-align: var(--align, center);
    display: flex;
    flex-wrap: wrap;
    gap: var(--cluster-gap);
    justify-content: var(--cluster-justify);
    align-items: var(--cluster-align);

    /* ðŸš€ Enhanced cluster with :where() for flexible variants */
    &:where(.cluster--center) {
      --cluster-justify: center;
    }

    &:where(.cluster--space-between) {
      --cluster-justify: space-between;
    }

    /* Enhanced styling based on child count */
    &:has(> :nth-child(n+4)) {
      --cluster-gap: var(--space-sm);
      font-size: var(--text-sm);
    }
  }

  .grid {
    display: grid;
    gap: var(--gap, var(--space-md));
  }

  /* ðŸŽ¨ Enhanced auto-grid with modern features */
  .auto-grid {
    display: grid;
    grid-template-columns: repeat(
      auto-fit,
      minmax(var(--min-width, 280px), 1fr)
    );
    gap: var(--gap, var(--space-md));
    container-type: inline-size;

    /* ðŸš€ Enhanced grid behavior with :has() and nesting */
    &:has(.grid-item--featured) {
      /* Adjust grid when featured items are present */
      grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
      --gap: var(--space-lg);

      .grid-item--featured {
        grid-column: span 2;
        background: linear-gradient(135deg, var(--color-primary) 0%, var(--color-accent) 100%);
        color: var(--color-on-primary);
        
        @container (max-width: 600px) {
          grid-column: span 1;
        }
      }
    }

    /* Dynamic sizing based on container width */
    @container (min-width: 1200px) {
      --min-width: 300px;
      --gap: var(--space-xl);
    }

    @container (max-width: 500px) {
      --min-width: 250px;
      --gap: var(--space-sm);
    }
  }

  .container {
    width: 100%;
    max-width: var(--max-width, 1200px);
    margin-inline: auto;
    padding-inline: var(--padding, var(--space-md));
  }

  /* Layout stabilization for route transitions */
  main {
    flex: 1;
    display: flex;
    flex-direction: column;
  }

  /* Modern page layout patterns */
  .page-container {
    flex: 1;
    display: flex;
    flex-direction: column;
    min-height: 60vh;
  }

  /* Content width containers - following 2025 patterns */
  .content-prose {
    width: var(--content-prose);
    margin-inline: auto;
    padding-inline: var(--space-md);
  }

  .content-reading {
    width: var(--content-reading);
    margin-inline: auto;
    padding-inline: var(--space-md);
  }

  .content-narrow {
    width: var(--content-narrow);
    margin-inline: auto;
    padding-inline: var(--space-md);
  }

  .content-wide {
    width: var(--content-wide);
    margin-inline: auto;
    padding-inline: var(--space-md);
  }

  .content-full {
    width: var(--content-full);
    padding-inline: var(--space-md);
  }

  /* Hero sections - full bleed with contained content */
  .hero-section {
    width: var(--content-full);
    container-type: inline-size;
  }

  .hero-content {
    width: var(--content-wide);
    margin-inline: auto;
    padding-inline: var(--space-md);
  }

  /* Smooth transitions */
  .fade-in {
    animation: fadeIn 0.2s ease-out;
  }

  @keyframes fadeIn {
    from {
      opacity: 0;
      transform: translateY(4px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
}
